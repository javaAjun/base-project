<!DOCTYPE html>
<html>


<!-- Mirrored from www.zi-han.net/theme/hplus/table_jqgrid.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 20 Jan 2016 14:20:02 GMT -->
<head>
  <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <title>閸氬骸褰寸粻锛勬倞</title>

    <link rel="shortcut icon" href="favicon.ico"> <link href="../hplus/css/bootstrap.min14ed.css?v=3.3.6" rel="stylesheet">
    <link href="../hplus/css/font-awesome.min93e3.css?v=4.4.0" rel="stylesheet">

    <!-- jqgrid-->
    <link href="../hplus/css/plugins/jqgrid/ui.jqgridffe4.css?0820" rel="stylesheet">

    <link href="../hplus/css/animate.min.css" rel="stylesheet">
    <link href="../hplus/css/style.min862f.css?v=4.1.0" rel="stylesheet">
	
	<script src="../hplus/js/jquery.min.js?v=2.1.4"></script>
    <script src="../hplus/js/bootstrap.min.js?v=3.3.6"></script>
    <script src="../hplus/js/plugins/peity/jquery.peity.min.js"></script>
    <script src="../hplus/js/plugins/jqgrid/i18n/grid.locale-cnffe4.js?0820"></script>
    <script src="../hplus/js/plugins/jqgrid/jquery.jqGrid.minffe4.js?0820"></script>
    <script src="../hplus/js/content.min.js?v=1.0.0"></script>
   <script src="../layer-v3.1.1/layer/layer.js"></script>
 
<script src="../js/common.js"></script>
<link rel="stylesheet" href="../css/common.css">
    
    <style>
        /* Additional style to fix warning dialog position */
        #xiangqing{display:block;padding:3px;margin-right:5px; background:#44BB5C;width:80px}
        #alertmod_table_list_2 {
            top: 900px !important;
        }
        #bigBody{margin-left:5px;margin-right:5px;margin-top:5px;margin-bottom:5px;
        padding-left:5px;padding-right:5px;padding-top:5px;padding-bottom:5px}
        #ibox-content{
        margin-left:5px;margin-right:5px;margin-top:5px;margin-bottom:5px;
        padding-left:5px;padding-right:5px;padding-top:5px;padding-bottom:5px
        }
        #gbox_table{margin-left:5px;margin-right:5px;margin-top:5px;margin-bottom:5px;
        padding-left:5px;padding-right:5px;padding-top:5px;padding-bottom:5px}
        .modal-content{
            position: relative;
              left: -150px;
             width: 950px;
        }
        #imgs_group{
         position: relative;
              left: -150px;
        }
        .ibox-content{
        padding: 0px 10px 20px;
        margin-top: 1px;
        }
        .ibox{
        margin-top: 1px;
        }
      
    </style>

</head>

<body class="gray-bg">
    <div class="wrapper wrapper-content  animated fadeInRight"  id="bigBody">
			    <div class="ibox-content">
			        <div class="row">
			           <div class="col-xs-3">
			               <a href="javascript:;" url="test.html" data-title="添加" onclick="layer_open(this,1)" class="btn btn-sm btn-primary">添加</a>
			           </div>
			           <div style="text-align: right;" id="seachForm">
                  <form class="form-inline" id="form-search" >
                    <div class="input-group">
                        <input type="text" class="form-control" id="value" name="value" placeholder="关键字查询">
                    </div>
                    <div class="input-group">
                        <select name="isAdminRecom" class="form-control" id="isAdminRecom">
                               <option value="">选择是否推荐</option>
                              <option value="1">是</option>
                              <option value="0">否</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <select name="isSale" class="form-control" id="isSale">
                               <option value="">状态</option>
                            <option value="1">上架</option>
                            <option value="0">下架</option>
                        </select>
                    </div>
                   
                    <div class="input-group">
                        <span class="input-group-btn">
                            <button class="btn-sm btn-primary" type="button" id ="search-btn" ><i class="fa fa-search"></i></button>
                        </span>
                        <span class="input-group-btn">
                            <button class="btn-sm btn-primary " type="button" id="search-clear"><i class="fa fa-undo"></i></button>
                        </span>
                    </div>
                </form>
                </div>
			 </div>
     
            
              <div class="ibox-content">
                <div class="ibox ">
                       <div class="jqGrid_wrapper">
                           <table id="table"></table>
                           <div id="pager_list_1"></div>
                       </div>
                    </div>
                </div>
            
        </div>
    </div>
   <script src="../js/pathjs.js"></script>
    <script>
        $(document).ready(function(){
      /*   $(".summernote").summernote({lang:"zh-CN"}); */
        
		$.jgrid.defaults.styleUI="Bootstrap";
	
		 $("#table").jqGrid({
	    url:HttpUrlCommon+_goodsList,
		//data:mydata,
		datatype:"json",
		height:"auto",
		autowidth:true,
		shrinkToFit:true,
		rowNum:10,
		sortname: 'id',
		rowList:[10,20,30],
		colNames:["序号ID","商品编号","名称","分类","市场价","店铺价格","库存","排序","状态","推荐","商品详情","操作"],
		colModel:[
					{name:"id",index:"id",editable:true,width:60,sorttype:"int",search:true},
					{name:"goodsNo",index:"goodsNo",editable:true,width:60},
					{name:"goodsName",index:"goodsName",editable:true,width:80},
					{name:"catName",index:"catName",editable:true,width:80},
					{name:"marketPrice",index:"marketPrice",editable:true,width:60,sorttype:"float"},
					{name:"shopPrice",index:"shopPrice",editable:true,width:60,sorttype:"float"},
					{name:"goodsStock",index:"goodsStock",editable:true,width:40},
					{name:"catSort",index:"catSort",width:40,sortable: true,formatter: function (a, b, c) {
	                    return '<input type="number" onchange="updateSort(this)" data-url="/admin/goods/changesort.html" class="form-control input-sm" data-id="'+c.id+'" data-old="'+a+'" value="'+a+'" />';
	                }},
					{name:"isSale",index:"isSale",editable: false,sortable: false,width:40,
						formatter:function(a,b,c){
							 if(a == false){
			                        return '<a href="javascript:;" data-id='+c.id+' data-status="0" onclick="setIsSale(this)"><span class="label label-danger" title="下架">下架</span></a>';
			                    } else{
			                        return '<a href="javascript:;" data-id='+c.id+' data-status="1" onclick="setIsSale(this)"><span class="label label-primary" title="上架">上架</span></a>';
			                    }
						}},
					{name:"isAdminRecom",index:"isAdminRecom",editable:true,width:40,
						formatter:function(a,b,c){
							 if(a == false){
			                        return '<a href="javascript:;" data-id='+c.id+' data-status="0" onclick="setIsAdminRecom(this)"><span class="label label-danger" title="否">否</span></a>';
			                    } else{
			                        return '<a href="javascript:;" data-id='+c.id+' data-status="1" onclick="setIsAdminRecom(this)"><span class="label label-primary"  title="是">是</span></a>';
			                    }
						}},
					{width:80,sortable: false,align:'left',formatter: function (a, b, c) {
	                    var btn = '<a href="admin_add.html?id='+c.id+'&name='+c.loginiNo+'&groupId='+c.groupId+'&url=admin_list.html">';
	                    btn += '<a href="javascript:;"><span class="label label-danger" id="xiangqing" title="详情"  data-id='+c.id+' onclick="del(this)">详情</span></a>';
	                    return btn;
                     }},
					{width:80,sortable: false,align:'left',formatter: function (a, b, c) {
						 var btn = '<a href="admin_add.html?id='+c.id+'&name='+c.loginiNo+'&groupId='+c.groupId+'&url=admin_list.html"><span class="label label-info" title="编辑">编辑</span></a>&nbsp;';
		                    btn += '<a href="javascript:;"><span class="label label-danger" title="删除"  data-id='+c.id+' onclick="del(this)">删除</span></a>';
		                    return btn;
                     }},
				],
		pager:"#pager_list_1",
		viewrecords:true,
		caption:"商品列表",
		hidegrid:false,
		jsonReader: {    //jsonReader来跟服务器端返回的数据做对应  
	           //包含实际数据的数组  
		        root: "data",  //包含实际数据的数组  
	            page: "pageInfo.pageNo",  //当前页  
	            total: "pageInfo.totalPages",//总页数  
	            records:"pageInfo.total", //查询出的记录数  
	            rowNum:"pageInfo.pageSize",
	            repeatitems : false  
	        }
		});
		/* $("#table").setSelection(4,true); */
		/* $("#table").jqGrid("navGrid","#pager_list_1",{del:true,search:true},{height:200,reloadAfterSubmit:true}); */
		$(window).bind("resize",function(){
			var width=$(".jqGrid_wrapper").width();
		    $("#table").setGridWidth(width)})
		});
     
        
        
        
        var edit=function(){
        	$("#eg").addClass("no-padding");
		    $(".click2edit").summernote({lang:"zh-CN",focus:true })};
		var save=function(){$("#eg").removeClass("no-padding");
	   var aHTML=$(".click2edit").code();$(".click2edit").destroy()};
	   
	   
		//查询
		$(function(){ 
	        $("#search-btn").click(function(){ 
	            var value = escape($("#value").val()); 
	            var isAdminRecom = escape($("#isAdminRecom").val()); 
	            var isSale=escape($("#isSale").val());
	            $("#table_list_1").jqGrid('setGridParam',{ 
	                url:HttpUrlCommon+_goodsList, 
	                postData:{'value':value,'isAdminRecom':isAdminRecom,"isSale":isSale}, //发送数据 
	                page:1 
	            }).trigger("reloadGrid"); //重新载入 
	        });
	        $("#search-clear").click(function(){ 
	            $("#table_list_1").jqGrid('setGridParam',{ 
	                url:HttpUrlCommon+_goodsList,
	                postData:{'value':"",'isAdminRecom':null,"isSale":null}, //发送数据 
	                page:1
	            }).trigger("reloadGrid"); //重新载入 
	        });
	    });
		//修改状态setIsSale  上架下架
		function setIsSale(a){
			var num=$(a).data("status");
			var isSale;
			if(num==0){
				isSale=1;
			}else{
				isSale=0;
			}
			var id=$(a).data("id");
			var dataParam={"id":id,"isSale":isSale};
			$.ajax({ 
				url:_editGoods, 
				data:dataParam, 
				type: "post",
		        dataType: "json",
		        async: 'false',
		        success: function (data) {
		           if(data.status=="200"){
		        	   var span=$(a).find("span");
		        	   if(num==0){
		        		   $(a).data("status",1);
		        		   $(span).attr("class","label label-primary");
		        		   $(span).attr("title","上架");
		        		   $(span).html("上架");
		        	   }else{
		        		   $(a).data("status",0);
		        		   $(span).attr("class","label label-danger");
		        		   $(span).attr("title","下架");
		        		   $(span).html("下架");
		        	   }
		           }else{
		        	   layer.msg("操作失败!");
		           }
		          }});
		}//修改是否推荐
		function setIsAdminRecom(a){
			var num=$(a).data("status");
			var isAdminRecom;
			if(num==0){
				isAdminRecom=1;
			}else{
				isAdminRecom=0;
			}
			var id=$(a).data("id");
			var dataParam={"id":id,"isAdminRecom":isAdminRecom};
			$.ajax({ 
				url:_editGoods, 
				data:dataParam, 
				type: "post",
		        dataType: "json",
		        async: 'false',
		        success: function (data) {
		           if(data.status=="200"){
		        	   var span=$(a).find("span");
		        	   if(num==0){
		        		   $(a).data("status",1);
		        		   $(span).attr("class","label label-primary");
		        		   $(span).attr("title","是");
		        		   $(span).html("是");
		        	   }else{
		        		   $(a).data("status",0);
		        		   $(span).attr("class","label label-danger");
		        		   $(span).attr("title","否");
		        		   $(span).html("否");
		        	   }
		           }else{
		        	   layer.msg("操作失败!");
		           }
		          }});
		}
		//删除
		function del(a){
	    	var id=$(a).data("id");
	    	layer.confirm('确定要删除此记录吗？', function(){ 
	    		layer.closeAll('dialog');
	    		$.ajax({ url: _delGoods, data:{id:id}, success: function(data){
	    	          layer.msg(data.message);
	    	          $("#table_list_1").trigger("reloadGrid");
	    	           }
	    	          });
	    		}); 
	    }
	
    </script>
</body>
</html>